# å°çº¢ä¹¦æœç´¢åŠŸèƒ½æˆåŠŸå®ç°è®°å½•

## ğŸ‰ é¡¹ç›®æˆåŠŸå…³é”®å› ç´ 

### æŠ€æœ¯æ¶æ„
- **å‰ç«¯**: Next.js 15 + TypeScript + Tailwind CSS
- **åç«¯**: FastAPI + Python
- **æ•°æ®æº**: XHSåº“ (ReaJason/xhs)
- **éƒ¨ç½²**: æœ¬åœ°å¼€å‘ç¯å¢ƒ

### æˆåŠŸçš„å…³é”®æ­¥éª¤

#### 1. CORSé…ç½®è§£å†³è·¨åŸŸé—®é¢˜
```python
from fastapi.middleware.cors import CORSMiddleware

app.add_middleware(
    CORSMiddleware,
    allow_origins=["http://localhost:3000"],  # Next.jså¼€å‘æœåŠ¡å™¨
    allow_credentials=True,
    allow_methods=["GET", "POST", "PUT", "DELETE", "OPTIONS"],
    allow_headers=["*"],
)
```

#### 2. æœ‰æ•ˆCookieçš„ä½¿ç”¨
- é€šè¿‡ç®€å•æµ‹è¯•è„šæœ¬éªŒè¯Cookieæœ‰æ•ˆæ€§
- ç¡¬ç¼–ç æµ‹è¯•æˆåŠŸçš„Cookieåˆ°æµ‹è¯•æœåŠ¡
- Cookieæ ¼å¼: å®Œæ•´çš„æµè§ˆå™¨Cookieå­—ç¬¦ä¸²

#### 3. æ­£ç¡®çš„APIè°ƒç”¨æ–¹å¼
```javascript
const response = await fetch('http://localhost:8002/search', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    keyword: keyword.trim(),
    page,
    page_size: 10,
    sort,
    cookie: ''
  })
})
```

#### 4. æ•°æ®å¤„ç†å’Œæå–
```python
# æ­£ç¡®æå–ç¬”è®°æ•°æ®
for item in items:
    if item.get('model_type') == 'note':
        note_card = item.get('note_card', {})
        # æå–å°é¢å›¾ç‰‡
        cover_url = "https://via.placeholder.com/300x400?text=No+Image"
        if note_card.get('cover'):
            if isinstance(note_card['cover'], dict):
                cover_url = note_card['cover'].get('url_default', cover_url)
```

### é—®é¢˜è§£å†³å†ç¨‹

#### é—®é¢˜1: æœç´¢è¿”å›ç©ºç»“æœ
- **åŸå› **: Cookieè¿‡æœŸæˆ–æ— æ•ˆ
- **è§£å†³**: ä½¿ç”¨æµ‹è¯•éªŒè¯è¿‡çš„æœ‰æ•ˆCookie

#### é—®é¢˜2: CORSè·¨åŸŸé”™è¯¯
- **åŸå› **: FastAPIæœåŠ¡æœªé…ç½®CORS
- **è§£å†³**: æ·»åŠ CORSMiddlewareä¸­é—´ä»¶

#### é—®é¢˜3: å‰ç«¯ç»„ä»¶å¯¼å…¥é”™è¯¯
- **åŸå› **: ç»„ä»¶å¯¼å‡ºæ–¹å¼ä¸åŒ¹é…
- **è§£å†³**: ä½¿ç”¨é»˜è®¤å¯¼å…¥æ–¹å¼

#### é—®é¢˜4: ç»“æœæ•°é‡è¿‡å¤š
- **åŸå› **: è¿”å›æ‰€æœ‰æœç´¢ç»“æœ
- **è§£å†³**: é™åˆ¶ä¸º10æ¡ç»“æœ

### æœ€ç»ˆå®ç°åŠŸèƒ½

1. âœ… çœŸå®æ•°æ®æœç´¢
2. âœ… åˆ†é¡µæ”¯æŒ
3. âœ… æ’åºåŠŸèƒ½ï¼ˆç»¼åˆ/æœ€æ–°/ç‚¹èµï¼‰
4. âœ… Cookieç®¡ç†ç³»ç»Ÿ
5. âœ… ç¾è§‚çš„UIç•Œé¢
6. âœ… å“åº”å¼è®¾è®¡
7. âœ… é”™è¯¯å¤„ç†å’ŒçŠ¶æ€æç¤º

### æ–‡ä»¶ç»“æ„
```
â”œâ”€â”€ app/test-simple/page.tsx          # å‰ç«¯æœç´¢ç•Œé¢
â”œâ”€â”€ test-fastapi-with-success-cookie.py  # æµ‹è¯•æœåŠ¡
â”œâ”€â”€ xhs-service/                      # XHSåº“æœåŠ¡
â””â”€â”€ å°çº¢ä¹¦æœç´¢åŠŸèƒ½æˆåŠŸå®ç°è®°å½•.md      # æœ¬æ–‡æ¡£
```

### éƒ¨ç½²è¯´æ˜
1. å¯åŠ¨æµ‹è¯•æœåŠ¡: `python test-fastapi-with-success-cookie.py`
2. å¯åŠ¨å‰ç«¯æœåŠ¡: `npm run dev`
3. è®¿é—®: http://localhost:3000/test-simple

### æ³¨æ„äº‹é¡¹
- Cookieéœ€è¦å®šæœŸæ›´æ–°
- æµ‹è¯•æœåŠ¡ä»…ç”¨äºå¼€å‘ç¯å¢ƒ
- ç”Ÿäº§ç¯å¢ƒéœ€è¦å®ç°CookieåŠ¨æ€ç®¡ç†

---
**åˆ›å»ºæ—¶é—´**: 2025å¹´8æœˆ23æ—¥  
**ç‰ˆæœ¬**: v1.0  
**çŠ¶æ€**: åŠŸèƒ½å®Œæ•´ï¼Œæµ‹è¯•é€šè¿‡