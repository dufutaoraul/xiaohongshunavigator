#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import requests
import json
import sys
import os

# Ê∑ªÂä†xhsÊ®°ÂùóË∑ØÂæÑ
sys.path.append(os.path.join(os.path.dirname(__file__), 'xhs-service'))

from xhs import XhsClient

def test_cookie_validity(cookie_str):
    """ÊµãËØïCookieÊòØÂê¶ÊúâÊïà"""
    print("üîç ÂºÄÂßãÊµãËØïCookieÊúâÊïàÊÄß...")
    print(f"üç™ CookieÈïøÂ∫¶: {len(cookie_str)}")
    
    try:
        # ÂàùÂßãÂåñÂÆ¢Êà∑Á´Ø
        client = XhsClient(cookie=cookie_str)
        print("‚úÖ XhsClientÂàùÂßãÂåñÊàêÂäü")
        
        # Â∞ùËØïÊêúÁ¥¢
        result = client.get_note_by_keyword("ÁæéÈ£ü", page=1, page_size=5, sort="general")
        print(f"üìä ÊêúÁ¥¢ÁªìÊûúÁ±ªÂûã: {type(result)}")
        print(f"üìä ÊêúÁ¥¢ÁªìÊûúÈîÆ: {list(result.keys()) if isinstance(result, dict) else 'Not a dict'}")
        
        if isinstance(result, dict):
            if 'items' in result and result['items']:
                print(f"‚úÖ CookieÊúâÊïàÔºÅÊâæÂà∞ {len(result['items'])} Êù°ÁªìÊûú")
                return True
            else:
                print("‚ùå CookieÂèØËÉΩÂ∑≤ËøáÊúü - Ê≤°ÊúâÊâæÂà∞itemsÂ≠óÊÆµÊàñÁªìÊûú‰∏∫Á©∫")
                print(f"üìä ÂÆåÊï¥ÁªìÊûú: {result}")
                return False
        else:
            print(f"‚ùå ÊÑèÂ§ñÁöÑÁªìÊûúÁ±ªÂûã: {type(result)}")
            return False
            
    except Exception as e:
        print(f"‚ùå ÊµãËØïÂ§±Ë¥•: {str(e)}")
        return False

if __name__ == "__main__":
    # ËøôÈáåÊîæÂÖ•‰Ω†ÂΩìÂâç‰ΩøÁî®ÁöÑCookie
    current_cookie = """a1=18e7e6b8b5bq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhqhq7ywqhq